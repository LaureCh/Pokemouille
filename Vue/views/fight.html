<div id="view-fight" style="display:none;">
  <h4>FIGHT !</h4>
  <canvas id="fight" width="480" height="320">
    <div style="display:none;">
      <img id="img-pokemon-dresseur" src="" width="96" height="96">
      <img id="img-pokemon-dresseur-2" src="" width="96" height="96">
      <img id="img-pokemon-dresseur-3" src="" width="96" height="96">
      <img id="img-pokemon-opponent" src="" width="96" height="96">
      <img id="img-pokemon-opponent-2" src="" width="96" height="96">
      <img id="img-pokemon-opponent-3" src="" width="96" height="96">
    </div>
  </canvas>
  <script type="text/javascript" src="../Vue/app/ressources/pokemon.js"></script>
  <script type="text/javascript" src="../Vue/app/ressources/dresseur.js"></script>
  <script type="text/javascript" src="../Vue/app/app.js"></script>

  <div class="row"><p>Liste des attaques :</p></div>
  <div class="row">
    <div class="col-4">
      <button type="button" class="btn btn-primary btn-block" onclick="attack(1);">Charge</button>
      <button type="button" class="btn btn-primary btn-block" onclick="attack(2);">Eclair</button>
      <button type="button" class="btn btn-primary btn-block" onclick="attack(3);">Morsure</button>
    </div>
  </div>

  <script>
    function attack(id){
      $.post(
          '../Controller/Fight.php',
          {
              attack : id
          },
          result_attack,
          'JSON'
      );
    }

    function result_attack(result){
      // Handling result battle
      opponent.team[opponent.pokemonActif].hp = result.opponent.hp;
      dresseur.team[dresseur.pokemonActif].attacking=true;

      // Oppenent switch if he's dead
      if(result.opponent.nextPokemon){
        opponent.pokemonActif = result.opponent.nextPokemon;
      }

      // Opponent attack
      setTimeout(function () {
        dresseur.team[dresseur.pokemonActif].hp = result.dresseur.hp;
        opponent.team[opponent.pokemonActif].attacking=true;

        // Dresseur switch if he's dead
        if(result.dresseur.nextPokemon){
          dresseur.pokemonActif = result.dresseur.nextPokemon;
        }
      }, 500);
    }
  </script>
</div>
